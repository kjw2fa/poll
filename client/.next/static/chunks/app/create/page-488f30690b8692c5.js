(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[323],{12830:(e,t,r)=>{"use strict";r.d(t,{Bc:()=>s,ZI:()=>u,k$:()=>d,m_:()=>o});var n=r(73365),i=r(1521),l=r(82115),a=r(19952);let s=l.Kq,o=l.bL,d=l.l9,u=i.forwardRef((e,t)=>{let{className:r,sideOffset:i=4,...s}=e;return(0,n.jsx)(l.UC,{ref:t,sideOffset:i,className:(0,a.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",r),...s})});u.displayName=l.UC.displayName},14469:(e,t,r)=>{"use strict";r.d(t,{p:()=>l});var n=r(73365);r(1521);var i=r(19952);function l(e){let{className:t,type:r="text",...l}=e;return(0,n.jsx)("input",{type:r,"data-slot":"input",className:(0,i.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...l})}},17183:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(73365);r(1521);let i=e=>{let{children:t}=e;return(0,n.jsx)("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 max-w-3xl",children:t})}},19952:(e,t,r)=>{"use strict";r.d(t,{cn:()=>l});var n=r(99783),i=r(5347);function l(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,i.QP)((0,n.$)(t))}},24075:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var n=r(73365),i=r(1521),l=r(14469),a=r(92547),s=r(29155),o=r(48158),d=r(12830);let u=e=>{let{poll:t,onSubmit:r}=e,[u,c]=(0,i.useState)(""),[p,m]=(0,i.useState)([]),[g,v]=(0,i.useState)("");(0,i.useEffect)(()=>{t&&(c(t.title),m(t.options))},[t]);let x=()=>{""!==g.trim()&&p.length<100&&(m([...p,{id:"",optionText:g.trim()}]),v(""))};return(0,n.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),p.length<2)return void o.oR.error("A poll must have at least two options.");r({title:u,options:p})},className:"flex flex-col gap-6",children:[(0,n.jsxs)("div",{className:"grid w-full items-center gap-1.5",children:[(0,n.jsx)(s.J,{htmlFor:"title",children:"Title"}),(0,n.jsx)(l.p,{type:"text",id:"title",value:u,onChange:e=>c(e.target.value),required:!0})]}),(0,n.jsxs)("div",{className:"grid w-full items-center gap-1.5",children:[(0,n.jsx)(s.J,{htmlFor:"new-option",children:"Add Option"}),(0,n.jsxs)("div",{className:"flex w-full items-center space-x-2",children:[(0,n.jsx)(l.p,{type:"text",id:"new-option",value:g,onChange:e=>{v(e.target.value)},onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),x())},className:"w-full"}),(0,n.jsx)(a.$,{type:"button",onClick:x,children:"Add Option"})]})]}),(0,n.jsxs)("div",{className:"grid w-full items-center gap-1.5",children:[(0,n.jsx)(s.J,{children:"Options"}),0===p.length?(0,n.jsx)("p",{className:"text-muted-foreground",children:"No options added yet. Add some options above."}):p.map((e,t)=>{let r=!!e.id,i=(0,n.jsxs)("div",{className:"flex w-full items-center space-x-2",children:[(0,n.jsx)(l.p,{type:"text",value:e.optionText,onChange:e=>((e,t)=>{let r=[...p];r[e]={...r[e],optionText:t.target.value},m(r)})(t,e),disabled:r}),(0,n.jsx)(a.$,{type:"button",variant:"destructive",onClick:()=>(e=>{let t=[...p];t.splice(e,1),m(t)})(t),disabled:r,children:"X"})]});return r?(0,n.jsxs)(d.m_,{children:[(0,n.jsx)(d.k$,{asChild:!0,children:i}),(0,n.jsx)(d.ZI,{children:(0,n.jsx)("p",{children:"Existing options cannot be edited or removed."})})]},t):(0,n.jsx)("div",{children:i},t)})]}),(0,n.jsx)(a.$,{type:"submit",children:t?"Save Changes":"Create Poll"})]})}},29155:(e,t,r)=>{"use strict";r.d(t,{J:()=>a});var n=r(73365);r(1521);var i=r(59731),l=r(19952);function a(e){let{className:t,...r}=e;return(0,n.jsx)(i.b,{"data-slot":"label",className:(0,l.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...r})}},29425:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});let n=function(){var e={defaultValue:null,kind:"LocalArgument",name:"options"},t={defaultValue:null,kind:"LocalArgument",name:"title"},r={defaultValue:null,kind:"LocalArgument",name:"userId"},n=[{kind:"Variable",name:"options",variableName:"options"},{kind:"Variable",name:"title",variableName:"title"},{kind:"Variable",name:"userId",variableName:"userId"}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:[e,t,r],kind:"Fragment",metadata:null,name:"pageMutation",selections:[{alias:null,args:n,concreteType:"Poll",kind:"LinkedField",name:"createPoll",plural:!1,selections:[i,{args:null,kind:"FragmentSpread",name:"PollCard_poll"}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[t,e,r],kind:"Operation",name:"pageMutation",selections:[{alias:null,args:n,concreteType:"Poll",kind:"LinkedField",name:"createPoll",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},{alias:null,args:null,concreteType:"PollOption",kind:"LinkedField",name:"options",plural:!0,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"optionText",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PollPermissions",kind:"LinkedField",name:"permissions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"permission_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"target_id",storageKey:null},i],storageKey:null}],storageKey:null}]},params:{cacheID:"1b9cc486012e1c199df6695f9d95938a",id:null,metadata:{},name:"pageMutation",operationKind:"mutation",text:"mutation pageMutation(\n  $title: String!\n  $options: [PollOptionInput!]!\n  $userId: ID!\n) {\n  createPoll(title: $title, options: $options, userId: $userId) {\n    id\n    ...PollCard_poll\n  }\n}\n\nfragment PollCard_poll on Poll {\n  id\n  title\n  options {\n    id\n    optionText\n  }\n  permissions {\n    permission_type\n    target_id\n    id\n  }\n}\n"}}}();n.hash="f2055e3e0a4509149aa8a5b445fac14d";let i=n},56275:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>v});var n=r(73365),i=r(1521),l=r(24075),a=r(72698),s=r(85638),o=r(17183),d=r(1702),u=r(48158),c=r(68698),p=r(88525);let m=r(29425),g=()=>{let e=(0,d.useRouter)(),{userId:t,loading:r}=(0,c.A)(),[i]=(0,a.useMutation)(m);return r?(0,n.jsx)("div",{children:"Loading..."}):t?(0,n.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Create a New Poll"}),(0,n.jsx)(l.A,{onSubmit:r=>{if(!t)return void u.oR.error("You must be logged in to create a poll.");i({variables:{title:r.title,options:r.options.map(e=>({optionText:e.optionText})),userId:t},onCompleted:t=>{var r;let n=null==(r=t.createPoll)?void 0:r.id;n&&(u.oR.success("Poll created successfully!"),e.push("/poll/".concat(n)))},onError:e=>{console.error("Error creating poll:",e),u.oR.error("Error creating poll.")},updater:e=>{e.invalidateStore()}})},poll:null})]}):(0,n.jsx)(p.A,{featureName:"create a poll"})},v=()=>(0,n.jsx)(o.A,{children:(0,n.jsx)(s.tH,{fallback:(0,n.jsx)("div",{children:"Something went wrong"}),children:(0,n.jsx)(i.Suspense,{fallback:(0,n.jsx)("div",{children:"Loading..."}),children:(0,n.jsx)(g,{})})})})},68698:(e,t,r)=>{"use strict";r.d(t,{A:()=>s,O:()=>a});var n=r(73365),i=r(1521);let l=(0,i.createContext)(void 0),a=e=>{let{children:t}=e,[r,a]=(0,i.useState)(null),[s,o]=(0,i.useState)(!0);return(0,i.useEffect)(()=>{a(localStorage.getItem("userId")),o(!1)},[]),(0,n.jsx)(l.Provider,{value:{userId:r,loading:s},children:t})},s=()=>{let e=(0,i.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},85638:(e,t,r)=>{"use strict";r.d(t,{tH:()=>a});var n=r(1521);let i=(0,n.createContext)(null),l={didCatch:!1,error:null};class a extends n.Component{static getDerivedStateFromError(e){return{didCatch:!0,error:e}}resetErrorBoundary(){let{error:e}=this.state;if(null!==e){for(var t,r,n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];null==(t=(r=this.props).onReset)||t.call(r,{args:i,reason:"imperative-api"}),this.setState(l)}}componentDidCatch(e,t){var r,n;null==(r=(n=this.props).onError)||r.call(n,e,t)}componentDidUpdate(e,t){let{didCatch:r}=this.state,{resetKeys:n}=this.props;if(r&&null!==t.error&&function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.length!==t.length||e.some((e,r)=>!Object.is(e,t[r]))}(e.resetKeys,n)){var i,a;null==(i=(a=this.props).onReset)||i.call(a,{next:n,prev:e.resetKeys,reason:"keys"}),this.setState(l)}}render(){let{children:e,fallbackRender:t,FallbackComponent:r,fallback:l}=this.props,{didCatch:a,error:s}=this.state,o=e;if(a){let e={error:s,resetErrorBoundary:this.resetErrorBoundary};if("function"==typeof t)o=t(e);else if(r)o=(0,n.createElement)(r,e);else if(void 0!==l)o=l;else throw s}return(0,n.createElement)(i.Provider,{value:{didCatch:a,error:s,resetErrorBoundary:this.resetErrorBoundary}},o)}constructor(e){super(e),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=l}}},88525:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(73365);r(1521);let i=e=>{let{featureName:t}=e;return(0,n.jsxs)("div",{className:"text-center p-8 border rounded-lg bg-gray-50",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold",children:"Login Required"}),(0,n.jsxs)("p",{className:"text-muted-foreground mt-2",children:["You must be logged in to ",t,"."]})]})}},88660:(e,t,r)=>{Promise.resolve().then(r.bind(r,56275))},92547:(e,t,r)=>{"use strict";r.d(t,{$:()=>o});var n=r(73365);r(1521);var i=r(35933),l=r(9395),a=r(19952);let s=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",secondary:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function o(e){let{className:t,variant:r,size:l,asChild:o=!1,...d}=e,u=o?i.DX:"button";return(0,n.jsx)(u,{"data-slot":"button",className:(0,a.cn)(s({variant:r,size:l,className:t})),...d})}}},e=>{e.O(0,[666,833,347,131,358],()=>e(e.s=88660)),_N_E=e.O()}]);