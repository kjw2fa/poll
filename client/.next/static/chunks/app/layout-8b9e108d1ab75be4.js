(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{952:()=>{},7089:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>s});let n=function(){var e={defaultValue:null,kind:"LocalArgument",name:"password"},a={defaultValue:null,kind:"LocalArgument",name:"usernameOrEmail"},t=[{alias:null,args:[{kind:"Variable",name:"password",variableName:"password"},{kind:"Variable",name:"usernameOrEmail",variableName:"usernameOrEmail"}],concreteType:"AuthPayload",kind:"LinkedField",name:"login",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"token",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"userId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[e,a],kind:"Fragment",metadata:null,name:"LoginMutation",selections:t,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,e],kind:"Operation",name:"LoginMutation",selections:t},params:{cacheID:"adc30f481ac885b0eeca9cba704f8e58",id:null,metadata:{},name:"LoginMutation",operationKind:"mutation",text:"mutation LoginMutation(\n  $usernameOrEmail: String!\n  $password: String!\n) {\n  login(usernameOrEmail: $usernameOrEmail, password: $password) {\n    token\n    userId\n    username\n  }\n}\n"}}}();n.hash="e0e15e7b564a93a4fb7f92f2671395f4";let s=n},12830:(e,a,t)=>{"use strict";t.d(a,{Bc:()=>l,ZI:()=>c,k$:()=>d,m_:()=>o});var n=t(73365),s=t(1521),r=t(82115),i=t(19952);let l=r.Kq,o=r.bL,d=r.l9,c=s.forwardRef((e,a)=>{let{className:t,sideOffset:s=4,...l}=e;return(0,n.jsx)(r.UC,{ref:a,sideOffset:s,className:(0,i.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",t),...l})});c.displayName=r.UC.displayName},14469:(e,a,t)=>{"use strict";t.d(a,{p:()=>r});var n=t(73365);t(1521);var s=t(19952);function r(e){let{className:a,type:t="text",...r}=e;return(0,n.jsx)("input",{type:t,"data-slot":"input",className:(0,s.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",a),...r})}},18674:(e,a,t)=>{Promise.resolve().then(t.bind(t,32324))},19952:(e,a,t)=>{"use strict";t.d(a,{cn:()=>r});var n=t(99783),s=t(5347);function r(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t];return(0,s.QP)((0,n.$)(a))}},29155:(e,a,t)=>{"use strict";t.d(a,{J:()=>i});var n=t(73365);t(1521);var s=t(59731),r=t(19952);function i(e){let{className:a,...t}=e;return(0,n.jsx)(s.b,{"data-slot":"label",className:(0,r.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",a),...t})}},32324:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>B});var n=t(73365),s=t(36460),r=t.n(s);t(952);var i=t(11570),l=t(80945);let o=async(e,a)=>{let t="/api/graphql";console.log("[Relay Fetch] URL:",t),console.log("[Relay Fetch] Operation:",e.name),console.log("[Relay Fetch] Variables:",JSON.stringify(a,null,2));let n={"Content-Type":"application/json"};{let e=localStorage.getItem("token");e&&(n.Authorization="Bearer ".concat(e))}try{let s=await fetch(t,{method:"POST",headers:n,body:JSON.stringify({query:e.text,variables:a})});console.log("[Relay Response] Status:",s.status),console.log("[Relay Response] Status Text:",s.statusText);let r=await s.text();if(console.log("[Relay Response] Body:",r),!s.ok)throw console.error("Relay fetch failed with status:",s.status),Error("Server responded with status ".concat(s.status));try{return JSON.parse(r)}catch(e){throw console.error("Failed to parse JSON response:",e),console.error("Original response text:",r),e}}catch(e){throw console.error("[Relay Fetch] Network error:",e),e}},d=new l.Environment({network:l.Network.create(o),store:new l.Store(new l.RecordSource),isServer:!1});var c=t(1521),u=t(18197),m=t.n(u),p=t(68789),g=t(9395),f=t(11007),x=t(19952);let h=c.forwardRef((e,a)=>{let{className:t,children:s,viewport:r,...i}=e;return(0,n.jsxs)(p.bL,{ref:a,className:(0,x.cn)("relative z-10 flex items-center justify-start",t),...i,children:[s,!1!==r&&(0,n.jsx)(w,{})]})});h.displayName=p.bL.displayName;let v=c.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,n.jsx)(p.B8,{ref:a,className:(0,x.cn)("group flex list-none items-center justify-center space-x-1",t),...s})});v.displayName=p.B8.displayName;let b=p.q7,y=(0,g.F)("group inline-flex h-9 w-max items-center justify-center rounded-md bg-transparent px-4 py-2 text-sm font-medium transition-colors hover:bg-primary hover:text-primary-foreground active:bg-primary active:text-primary-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50");c.forwardRef((e,a)=>{let{className:t,children:s,...r}=e;return(0,n.jsxs)(p.l9,{ref:a,className:(0,x.cn)(y(),"group",t),...r,children:[s," ",(0,n.jsx)(f.A,{className:"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180","aria-hidden":"true"})]})}).displayName=p.l9.displayName,c.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,n.jsx)(p.UC,{ref:a,className:(0,x.cn)("left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion^=from-]:zoom-in-95 data-[motion^=to-]:zoom-out-95 data-[orientation=portrait]:data-[motion^=from-]:slide-in-from-top-5 data-[orientation=portrait]:data-[motion^=to-]:slide-out-to-top-5 data-[orientation=landscape]:data-[motion^=from-]:slide-in-from-left-5 data-[orientation=landscape]:data-[motion^=to-]:slide-out-to-right-5 md:absolute md:w-auto",t),...s})}).displayName=p.UC.displayName;let j=c.forwardRef((e,a)=>{let{className:t,children:s,active:r,...i}=e;return(0,n.jsx)(p.N_,{ref:a,className:(0,x.cn)(y(),t),active:r,...i,children:s})});j.displayName=p.N_.displayName;let w=c.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,n.jsx)("div",{className:(0,x.cn)("absolute left-0 top-full flex justify-center"),children:(0,n.jsx)(p.LM,{className:(0,x.cn)("relative h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]",t),ref:a,...s})})});w.displayName=p.LM.displayName,c.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,n.jsx)(p.C1,{ref:a,className:(0,x.cn)("top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in",t),...s,children:(0,n.jsx)("div",{className:"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border"})})}).displayName=p.C1.displayName;let N=e=>{let{loggedIn:a,username:t,onLogout:s,setIsLoginModalOpen:r,setIsSignupModalOpen:i}=e;return(0,n.jsxs)("div",{className:"flex justify-between w-full px-4 py-2",children:[(0,n.jsx)(h,{children:(0,n.jsxs)(v,{children:[(0,n.jsx)(b,{children:(0,n.jsx)(j,{asChild:!0,className:y(),children:(0,n.jsx)(m(),{href:"/",children:"Home"})})}),(0,n.jsx)(b,{children:(0,n.jsx)(j,{asChild:!0,className:y(),children:(0,n.jsx)(m(),{href:"/create",children:"Create Poll"})})}),(0,n.jsx)(b,{children:(0,n.jsx)(j,{asChild:!0,className:y(),children:(0,n.jsx)(m(),{href:"/poll",children:"View Polls"})})}),(0,n.jsx)(b,{children:(0,n.jsx)(j,{asChild:!0,className:y(),children:(0,n.jsx)(m(),{href:"/mypolls",children:"My Polls"})})})]})}),(0,n.jsx)(h,{children:(0,n.jsx)(v,{children:a?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(b,{children:(0,n.jsxs)("span",{className:"cursor-default mr-1",children:["Welcome, ",t]})}),(0,n.jsx)(b,{children:(0,n.jsx)("button",{onClick:s,className:y(),children:"Logout"})})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(b,{children:(0,n.jsx)("button",{onClick:()=>i(!0),className:y(),children:"Sign Up"})}),(0,n.jsx)(b,{children:(0,n.jsx)("button",{onClick:()=>r(!0),className:y(),children:"Login"})})]})})})]})};var k=t(72698),S=t(92547),C=t(84508),L=t(17687);let R=C.bL;C.l9;let O=C.ZL;C.bm;let E=c.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,n.jsx)(C.hJ,{ref:a,className:(0,x.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s})});E.displayName=C.hJ.displayName;let F=c.forwardRef((e,a)=>{let{className:t,children:s,...r}=e;return(0,n.jsxs)(O,{children:[(0,n.jsx)(E,{}),(0,n.jsxs)(C.UC,{ref:a,className:(0,x.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...r,children:[s,(0,n.jsxs)(C.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,n.jsx)(L.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});F.displayName=C.UC.displayName;let I=e=>{let{className:a,...t}=e;return(0,n.jsx)("div",{className:(0,x.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a),...t})};I.displayName="DialogHeader";let z=c.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,n.jsx)(C.hE,{ref:a,className:(0,x.cn)("text-lg font-semibold leading-none tracking-tight",t),...s})});z.displayName=C.hE.displayName;let $=c.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,n.jsx)(C.VY,{ref:a,className:(0,x.cn)("text-sm text-muted-foreground",t),...s})});$.displayName=C.VY.displayName;var A=t(14469),M=t(29155);let P=t(7089),V=e=>{let{isOpen:a,onClose:t,onLogin:s,onSwitchToSignup:r}=e,[i,l]=(0,c.useState)(""),[o,d]=(0,c.useState)(""),[u,m]=(0,c.useState)(""),[p,g]=(0,k.useMutation)(P),f=()=>{p({variables:{usernameOrEmail:i,password:o},onCompleted:e=>{if(e.login){let{token:a,userId:n,username:r}=e.login;m("Login successful!"),s&&s({token:a,userId:n,username:r}),t()}else m("Login failed. Please check your username and password.")},onError:e=>{m(e.message||"Login failed.")}})};return(0,n.jsx)(R,{open:a,onOpenChange:t,children:(0,n.jsxs)(F,{className:"sm:max-w-[425px]",children:[(0,n.jsxs)(I,{className:"text-center",children:[(0,n.jsx)(z,{className:"text-xl",children:"Welcome back!"}),(0,n.jsx)($,{children:"Please sign in to your account"})]}),(0,n.jsx)("form",{onSubmit:e=>{e.preventDefault(),f()},children:(0,n.jsxs)("div",{className:"grid gap-4",children:[(0,n.jsxs)("div",{className:"grid gap-2",children:[(0,n.jsx)(M.J,{htmlFor:"usernameOrEmail",children:"Username or Email"}),(0,n.jsx)(A.p,{id:"usernameOrEmail",type:"text",placeholder:"m@example.com",required:!0,value:i,onChange:e=>l(e.target.value)})]}),(0,n.jsxs)("div",{className:"grid gap-2",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(M.J,{htmlFor:"password",children:"Password"}),(0,n.jsx)("a",{href:"#",className:"ml-auto text-sm underline-offset-4 hover:underline",children:"Forgot your password?"})]}),(0,n.jsx)(A.p,{id:"password",type:"password",required:!0,value:o,onChange:e=>d(e.target.value),onKeyDown:e=>"Enter"===e.key&&f()})]}),(0,n.jsx)(S.$,{type:"submit",className:"w-full",disabled:g,children:"Login"}),(0,n.jsxs)("div",{className:"text-center text-sm",children:["Don't have an account?"," ",(0,n.jsx)(S.$,{variant:"link",onClick:r,type:"button",children:"Sign up"})]})]})}),u&&(0,n.jsx)("p",{children:u})]})})},K=t(43043),J=e=>{let{isOpen:a,onClose:t,onSignupSuccess:s,onSwitchToLogin:r}=e,[i,l]=(0,c.useState)(""),[o,d]=(0,c.useState)(""),[u,m]=(0,c.useState)(""),[p,g]=(0,c.useState)(""),[f,x]=(0,k.useMutation)(K);return(0,n.jsx)(R,{open:a,onOpenChange:e=>{e||g(""),t()},children:(0,n.jsxs)(F,{className:"sm:max-w-[425px]",children:[(0,n.jsxs)(I,{className:"text-center mb-6",children:[(0,n.jsx)(z,{className:"text-3xl font-bold",children:"Create Account"}),(0,n.jsx)($,{children:"Enter your details below to create an account."})]}),(0,n.jsxs)("div",{className:"grid gap-4",children:[(0,n.jsxs)("div",{className:"grid gap-2",children:[(0,n.jsx)(M.J,{htmlFor:"username",children:"Username"}),(0,n.jsx)(A.p,{type:"text",id:"username",placeholder:"Username",value:i,onChange:e=>l(e.target.value)})]}),(0,n.jsxs)("div",{className:"grid gap-2",children:[(0,n.jsx)(M.J,{htmlFor:"email",children:"Email"}),(0,n.jsx)(A.p,{type:"email",id:"email",placeholder:"Email",value:o,onChange:e=>d(e.target.value)})]}),(0,n.jsxs)("div",{className:"grid gap-2",children:[(0,n.jsx)(M.J,{htmlFor:"password",children:"Password"}),(0,n.jsx)(A.p,{type:"password",id:"password",placeholder:"Password",value:u,onChange:e=>m(e.target.value)})]}),(0,n.jsx)(S.$,{onClick:()=>{f({variables:{username:i,email:o,password:u},onCompleted:e=>{e.signup&&(g("Signup successful!"),s({userId:e.signup.id,username:e.signup.username}))},onError:e=>{g(e.message||"Signup failed.")}})},disabled:x,className:"w-full",children:"Create Account"}),p&&(0,n.jsx)("div",{children:p}),(0,n.jsxs)("div",{className:"text-center text-sm",children:["Already have an account?"," ",(0,n.jsx)(S.$,{variant:"link",onClick:r,type:"button",children:"Login"})]})]})]})})};var U=t(1702),_=t(48158);let D=()=>{let[e,a]=(0,c.useState)(!1),[t,s]=(0,c.useState)(""),[r,i]=(0,c.useState)(!1),[l,o]=(0,c.useState)(!1),d=(0,U.useRouter)();return(0,c.useEffect)(()=>{let e=localStorage.getItem("token"),t=localStorage.getItem("username");a(!!e),s(t||"")},[]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(N,{loggedIn:e,username:t,onLogout:()=>{localStorage.removeItem("token"),localStorage.removeItem("userId"),localStorage.removeItem("username"),a(!1),s(""),d.push("/"),d.refresh()},setIsLoginModalOpen:i,setIsSignupModalOpen:o}),(0,n.jsx)(V,{isOpen:r,onClose:()=>i(!1),onLogin:e=>{let{token:t,userId:n,username:r}=e;localStorage.setItem("token",t),localStorage.setItem("userId",n),localStorage.setItem("username",r),a(!0),s(r),i(!1),d.refresh()},onSwitchToSignup:()=>{i(!1),o(!0)}}),(0,n.jsx)(J,{isOpen:l,onClose:()=>o(!1),onSignupSuccess:()=>{o(!1),_.oR.success("Account successfully created!"),i(!0)},onSwitchToLogin:()=>{o(!1),i(!0)}})]})};var q=t(12830),T=t(68698);function B(e){let{children:a}=e;return(0,n.jsx)("html",{lang:"en",children:(0,n.jsx)("body",{className:r().className,children:(0,n.jsx)(i.RelayEnvironmentProvider,{environment:d,children:(0,n.jsx)(q.Bc,{children:(0,n.jsxs)(T.O,{children:[(0,n.jsx)(D,{}),(0,n.jsx)("main",{className:"pt-16 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a}),(0,n.jsx)(_.l$,{})]})})})})})}},43043:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>s});let n=function(){var e={defaultValue:null,kind:"LocalArgument",name:"email"},a={defaultValue:null,kind:"LocalArgument",name:"password"},t={defaultValue:null,kind:"LocalArgument",name:"username"},n=[{alias:null,args:[{kind:"Variable",name:"email",variableName:"email"},{kind:"Variable",name:"password",variableName:"password"},{kind:"Variable",name:"username",variableName:"username"}],concreteType:"User",kind:"LinkedField",name:"signup",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[e,a,t],kind:"Fragment",metadata:null,name:"SignupMutation",selections:n,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[t,e,a],kind:"Operation",name:"SignupMutation",selections:n},params:{cacheID:"e6e7612fda144db851c13146202102bc",id:null,metadata:{},name:"SignupMutation",operationKind:"mutation",text:"mutation SignupMutation(\n  $username: String!\n  $email: String!\n  $password: String!\n) {\n  signup(username: $username, email: $email, password: $password) {\n    id\n    username\n  }\n}\n"}}}();n.hash="834ea386638e18a8d03fcce6fc278328";let s=n},68698:(e,a,t)=>{"use strict";t.d(a,{A:()=>l,O:()=>i});var n=t(73365),s=t(1521);let r=(0,s.createContext)(void 0),i=e=>{let{children:a}=e,[t,i]=(0,s.useState)(null),[l,o]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{i(localStorage.getItem("userId")),o(!1)},[]),(0,n.jsx)(r.Provider,{value:{userId:t,loading:l},children:a})},l=()=>{let e=(0,s.useContext)(r);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},92547:(e,a,t)=>{"use strict";t.d(a,{$:()=>o});var n=t(73365);t(1521);var s=t(35933),r=t(9395),i=t(19952);let l=(0,r.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",secondary:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function o(e){let{className:a,variant:t,size:r,asChild:o=!1,...d}=e,c=o?s.DX:"button";return(0,n.jsx)(c,{"data-slot":"button",className:(0,i.cn)(l({variant:t,size:r,className:a})),...d})}}},e=>{e.O(0,[954,666,833,197,729,656,347,131,358],()=>e(e.s=18674)),_N_E=e.O()}]);